<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2026 航班預約 - 強化文字提示</title>
    <style>
      body {
        font-family: "Microsoft JhengHei", sans-serif;
        padding: 20px;
        background: #f9f9f9;
      }

      .date-selector-wrapper {
        display: flex;
        align-items: center;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        width: 100%;
        max-width: 600px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        overflow: hidden;
      }

      .date-btn-container {
        flex: 1;
        padding: 15px 25px;
        cursor: pointer;
        transition: background 0.2s;
      }
      /* .date-btn-container:hover {
        background: #fafafa;
      } */
      .date-btn-container:hover .value {
        color: #ff625d;
      }
      #startBox {
        text-align: left;
      }
      #endBox {
        text-align: right;
      }

      .label {
        font-size: 12px;
        color: #888;
        display: block;
        margin-bottom: 4px;
        pointer-events: none;
      }
      .value {
        font-size: 17px;
        font-weight: bold;
        color: #333;
        pointer-events: none;
      }

      .separator {
        width: 60px;
        align-self: stretch;
        color: #bbb;
        font-weight: bold;
        font-size: 22px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background 0.2s;
        /* border-left: 1px solid #f0f0f0;
        border-right: 1px solid #f0f0f0; */
      }
      .separator:hover {
        background: #fafafa;
        color: #ff625d;
      }

      /* --- 日曆樣式 --- */
      @media (min-width: 992px) {
        .container-rel {
          position: relative;
          width: fit-content;
        }
        .calendar {
          position: absolute;
          top: 85px;
          left: 0;
          opacity: 0;
          visibility: hidden;
          background: #fff;
          border: 1px solid #ddd;
          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
          padding: 15px;
          z-index: 999;
          border-radius: 12px;
          width: 600px;
          box-sizing: border-box;
          transition: all 0.3s ease;
        }
        .calendar.active {
          opacity: 1;
          visibility: visible;
        }
        .month-container {
          display: flex;
          flex-direction: row;
          gap: 20px;
        }
      }

      table {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
      }
      th {
        color: #ff625d;
        font-size: 13px;
        padding-bottom: 10px;
      }
      td {
        height: 50px;
        text-align: center;
        cursor: pointer;
        position: relative;
        font-size: 14px;
      }
      td.disabled {
        color: #ccc !important;
      }

      /* 選中狀態：背景變紅，文字變白 */
      td.start-date,
      td.end-date,
      td.hover-end {
        background: #ff625d !important;
        color: #fff !important;
        border-radius: 6px;
        z-index: 2;
      }

      /* 區間狀態：淺紅背景 */
      td.in-range::before,
      td.hover-range::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 98, 93, 0.1);
        z-index: 0;
      }

      .date-box {
        position: relative;
        z-index: 3;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      /* --- 重點：提示文字樣式 --- */
      .txt {
        font-size: 11px;
        font-weight: bold;
        height: 14px;
        margin-top: 2px;
        color: transparent; /* 預設隱藏 */
      }

      /* 當被選中時，顯示提示文字 (在紅底上顯示白色) */
      td.start-date .txt,
      td.end-date .txt,
      td.hover-end .txt {
        color: #fff;
      }

      /* 如果是滑動預覽中的區間文字，顯示紅色 */
      td.hover-range .txt {
        color: #ff625d;
      }

      .editing-hint {
        color: #ff625d;
        font-size: 13px;
        margin-bottom: 15px;
        font-weight: bold;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
      }
      .nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }
      .nav button {
        background: #f0f0f0;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <div class="container-rel">
      <div class="date-selector-wrapper">
        <div class="date-btn-container" id="startBox">
          <span class="value" id="startVal"></span>
        </div>
        <div class="separator" id="rangeBtn">~</div>
        <div class="date-btn-container" id="endBox">
          <span class="value" id="endVal"></span>
        </div>
      </div>

      <div class="calendar" id="calendar">
        <div id="statusHint" class="editing-hint"></div>
        <div class="month-container">
          <div class="month-box">
            <div class="nav">
              <button id="prevBtn">❮</button><span id="title1"></span
              ><span></span>
            </div>
            <div id="table1"></div>
          </div>
          <div class="month-box">
            <div class="nav">
              <span></span><span id="title2"></span
              ><button id="nextBtnPC">❯</button>
            </div>
            <div id="table2"></div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const calendar = document.getElementById("calendar");
      const statusHint = document.getElementById("statusHint");

      let startDate = new Date(2026, 0, 14); // 預設 1/14
      let endDate = new Date(2026, 1, 28); // 預設 2/28
      let viewDate = new Date(2026, 0, 1);
      const today = new Date(2026, 0, 1);
      let activeMode = "range";
      let rangeStep = 0;

      function render() {
        const m1 = new Date(viewDate.getFullYear(), viewDate.getMonth(), 1);
        const m2 = new Date(viewDate.getFullYear(), viewDate.getMonth() + 1, 1);
        document.getElementById(
          "title1"
        ).textContent = `${m1.getFullYear()}年 ${m1.getMonth() + 1}月`;
        document.getElementById(
          "title2"
        ).textContent = `${m2.getFullYear()}年 ${m2.getMonth() + 1}月`;
        document.getElementById("table1").innerHTML = createTable(m1);
        document.getElementById("table2").innerHTML = createTable(m2);
        updateUI();
        attachEvents();
      }

      function createTable(monthDate) {
        const y = monthDate.getFullYear(),
          m = monthDate.getMonth();
        const firstDay = new Date(y, m, 1).getDay();
        const lastDate = new Date(y, m + 1, 0).getDate();
        let html =
          "<table><tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr><tr>";
        for (let i = 0; i < firstDay; i++) html += "<td></td>";
        for (let d = 1; d <= lastDate; d++) {
          const curr = new Date(y, m, d);
          html += `<td data-date="${y}-${m + 1}-${d}" class="${
            curr < today ? "disabled" : ""
          }">
                      <div class="date-box"><span>${d}</span><span class="txt"></span></div>
                    </td>`;
          if ((firstDay + d) % 7 === 0) html += "</tr><tr>";
        }
        return html + "</tr></table>";
      }

      function updateUI() {
        document.querySelectorAll("td[data-date]").forEach((td) => {
          const curr = new Date(td.dataset.date.replace(/-/g, "/"));
          const txt = td.querySelector(".txt");
          td.classList.remove(
            "start-date",
            "end-date",
            "in-range",
            "hover-range",
            "hover-end"
          );
          txt.textContent = "";

          if (startDate && curr.getTime() === startDate.getTime()) {
            td.classList.add("start-date");
            txt.textContent = "出發"; // 點選後出現文字
          }
          if (endDate && curr.getTime() === endDate.getTime()) {
            td.classList.add("end-date");
            txt.textContent = "抵達"; // 點選後出現文字
          }
          if (startDate && endDate && curr > startDate && curr < endDate)
            td.classList.add("in-range");
        });

        if (activeMode === "start") statusHint.textContent = "更改 [出發日期]";
        else if (activeMode === "end")
          statusHint.textContent = "更改 [抵達日期]";
        else
          statusHint.textContent =
            rangeStep === 0 ? "請點選 [去程日期]" : "請點選 [回程日期]";
      }

      function attachEvents() {
        document.querySelectorAll("td[data-date]").forEach((td) => {
          if (td.classList.contains("disabled")) return;

          td.onclick = () => {
            const clicked = new Date(td.dataset.date.replace(/-/g, "/"));
            if (activeMode === "start") {
              startDate = clicked;
              if (endDate && startDate >= endDate) endDate = null;
              hideCalendar();
            } else if (activeMode === "end") {
              endDate = clicked;
              if (startDate && endDate < startDate) {
                startDate = endDate;
                endDate = null;
              }
              hideCalendar();
            } else {
              if (rangeStep === 0) {
                startDate = clicked;
                endDate = null;
                rangeStep = 1;
              } else {
                if (clicked < startDate) {
                  startDate = clicked;
                } else {
                  endDate = clicked;
                  hideCalendar();
                }
              }
            }
            updateDisplay();
            updateUI();
          };

          td.onmouseenter = () => {
            if (
              activeMode !== "range" ||
              rangeStep !== 1 ||
              !startDate ||
              endDate
            )
              return;
            const hoverDate = new Date(td.dataset.date.replace(/-/g, "/"));
            if (hoverDate <= startDate) return;

            document.querySelectorAll("td[data-date]").forEach((t) => {
              const c = new Date(t.dataset.date.replace(/-/g, "/"));
              const tTxt = t.querySelector(".txt");
              t.classList.remove("hover-range", "hover-end");
              if (tTxt.textContent === "回程") tTxt.textContent = "";

              if (c > startDate && c < hoverDate)
                t.classList.add("hover-range");
              else if (c.getTime() === hoverDate.getTime()) {
                t.classList.add("hover-end");
                tTxt.textContent = "回程";
              }
            });
          };

          td.onmouseleave = () => {
            if (activeMode === "range" && rangeStep === 1) updateUI();
          };
        });
      }

      function updateDisplay() {
        const fmt = (d) =>
          d
            ? `${d.getFullYear()}/${(d.getMonth() + 1)
                .toString()
                .padStart(2, "0")}/${d.getDate().toString().padStart(2, "0")}`
            : "選擇日期";
        document.getElementById("startVal").textContent = fmt(startDate);
        document.getElementById("endVal").textContent = fmt(endDate);
      }

      function showCalendar(mode) {
        activeMode = mode;
        if (mode === "range") rangeStep = 0;
        if (startDate)
          viewDate = new Date(startDate.getFullYear(), startDate.getMonth(), 1);
        calendar.classList.add("active");
        render();
      }

      function hideCalendar() {
        calendar.classList.remove("active");
      }

      document.getElementById("startBox").onclick = () => showCalendar("start");
      document.getElementById("endBox").onclick = () => showCalendar("end");
      document.getElementById("rangeBtn").onclick = () => showCalendar("range");

      document.getElementById("nextBtnPC").onclick = () => {
        viewDate.setMonth(viewDate.getMonth() + 1);
        render();
      };
      document.getElementById("prevBtn").onclick = () => {
        viewDate.setMonth(viewDate.getMonth() - 1);
        render();
      };

      updateDisplay();
    </script>
  </body>
</html>
